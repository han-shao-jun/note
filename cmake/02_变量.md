## 定义变量
`CMake 变量`的值总是以`字符串类型`，尽管一些命令可能会**将字符串解释为其他类型的值**，例如`布尔值`、`数值`、`路径`。**变量名称区分大小写**，几乎可以由任何文本组成。
使用 `set()` 和 `unset()` 命令显示的**设置或取消设置变量**，但其他命令也具有修改变量的功能。
### 1.常规变量
```cmake
# 设置常规变量吗，有多个值变成list
set(<variable> <value> ...)

# 取消常规变量
unset(<variable>)

```
`常规变量`使用 `${<variable>}` 语法进行引用，与shell脚本相同

```cmake
cmake_minimum_required(VERSION 3.0.0)

# 字符串类型，解释为列表类型用 `;` 分隔
set(PATHs "/tmp" "/bin" "/lib")
message("${PATHs}")

foreach(PATH ${PATHs})
 if(PATH)
  message(${PATH})
 endif()
endforeach()

unset(PATHs)
# or 
# set(PATHs "")

```

### 2.缓存变量

CMake 存储一组单独的 "缓存变量" 或 "缓存条目"，因为在项目构建树中的多次运行时，我们需要变量的值保持不变。
构建文件夹下`CMakeCache.txt` 文件用于存储缓存条目，第一次构建时会生成该文件，之后的构建并不会创建该文件。
使用 `$CACHE{<variable>}` 或 `${<variable>}` 引用缓存条目的值。
一般的情况下，我们不会在源码文件中去设置或取消设置缓存的变量，我们只会引用它，但是有一些编译参数也是缓存变量需要修改。

```cmake
# 设置缓存条目
set(<variable> <value> ... CACHE <type> <docstring> [FORCE])

# 取消缓存条目
unset(<variable> CACHE)
```

缓存变量的类型`type`可以取:
* BOOL: 布尔 ON/OFF 值
* FILEPATH: 文件的路径
* PATH: 目录的路径
* STRING: 目录的路径

参数 `docstring` 对变量的注释信息，会在`CMakeCache.txt` 文件显示

在使用 set() 命令时，默认情况下，如果缓存条目在 CMakeCache.txt 文件不存在，会创建缓存条目，并写入到 CMakeCache.txt 文件中。如果缓存条目在 CMakeCache.txt 文件存在，忽略 set() 命令，不会覆盖现有的缓存条目。但是我们想强制覆盖现有的缓存条目，我们可以 FORCE 选项。

```cmake
set(BUILD_DEBUG "ON" CACHE STRING "Value Created by Me")
message("BUILD_DEBUG: ${BUILD_DEBUG}")
```

部分`CMakeCache.txt` 文件内容
```cmake
# This is the CMakeCache file.
# For build in directory: d:/code/cmake/template/add_source/build
# It was generated by CMake: C:/Programs/CLion2023.3.4/bin/cmake/win/x64/bin/cmake.exe
# You can edit this file to change values found and used by cmake.
# If you do not want to change any of the values, simply exit the editor.
# If you do want to change a value, simply edit, save, and exit the editor.
# The syntax for the file is as follows:
# KEY:TYPE=VALUE
# KEY is the name of a variable in the cache.
# TYPE is a hint to GUIs for the type of VALUE, DO NOT EDIT TYPE!.
# VALUE is the current value for the KEY.

########################
# EXTERNAL cache entries
########################

//Path to a program.
CMAKE_ADDR2LINE:FILEPATH=G:/app/mingw64/bin/addr2line.exe

//Path to a program.
CMAKE_AR:FILEPATH=G:/app/mingw64/bin/ar.exe

//No help, variable specified on the command line.
CMAKE_BUILD_TYPE:STRING=Debug

//No help, variable specified on the command line.
CMAKE_CXX_COMPILER:FILEPATH=G:/app/mingw64/bin/g++.exe

//No help, variable specified on the command line.
CMAKE_C_COMPILER:FILEPATH=G:/app/mingw64/bin/gcc.exe

//A wrapper around 'ar' adding the appropriate '--plugin' option
// for the GCC compiler
CMAKE_C_COMPILER_AR:FILEPATH=G:/app/mingw64/bin/gcc-ar.exe

//A wrapper around 'ranlib' adding the appropriate '--plugin' option
// for the GCC compiler
CMAKE_C_COMPILER_RANLIB:FILEPATH=G:/app/mingw64/bin/gcc-ranlib.exe

//Flags used by the C compiler during all build types.
CMAKE_C_FLAGS:STRING=

//Flags used by the C compiler during DEBUG builds.
CMAKE_C_FLAGS_DEBUG:STRING=-g

//Flags used by the C compiler during MINSIZEREL builds.
CMAKE_C_FLAGS_MINSIZEREL:STRING=-Os -DNDEBUG

//Flags used by the C compiler during RELEASE builds.
CMAKE_C_FLAGS_RELEASE:STRING=-O3 -DNDEBUG

//Flags used by the C compiler during RELWITHDEBINFO builds.
CMAKE_C_FLAGS_RELWITHDEBINFO:STRING=-O2 -g -DNDEBUG

//Libraries linked by default with all C applications.
CMAKE_C_STANDARD_LIBRARIES:STRING=-lkernel32 -luser32 -lgdi32 -lwinspool -lshell32 -lole32 -loleaut32 -luuid -lcomdlg32 -ladvapi32

//Path to a program.
CMAKE_DLLTOOL:FILEPATH=G:/app/mingw64/bin/dlltool.exe

//Flags used by the linker during all build types.
CMAKE_EXE_LINKER_FLAGS:STRING=

//Flags used by the linker during DEBUG builds.
CMAKE_EXE_LINKER_FLAGS_DEBUG:STRING=

//Flags used by the linker during MINSIZEREL builds.
CMAKE_EXE_LINKER_FLAGS_MINSIZEREL:STRING=

//Flags used by the linker during RELEASE builds.
CMAKE_EXE_LINKER_FLAGS_RELEASE:STRING=

//Flags used by the linker during RELWITHDEBINFO builds.
CMAKE_EXE_LINKER_FLAGS_RELWITHDEBINFO:STRING=

//No help, variable specified on the command line.
CMAKE_EXPORT_COMPILE_COMMANDS:BOOL=TRUE

//Path to a program.
CMAKE_NM:FILEPATH=G:/app/mingw64/bin/nm.exe

//Path to a program.
CMAKE_OBJCOPY:FILEPATH=G:/app/mingw64/bin/objcopy.exe

//Path to a program.
CMAKE_OBJDUMP:FILEPATH=G:/app/mingw64/bin/objdump.exe

//Value Computed by CMake
CMAKE_PROJECT_DESCRIPTION:STATIC=

//Value Computed by CMake
CMAKE_PROJECT_HOMEPAGE_URL:STATIC=

//Value Computed by CMake
CMAKE_PROJECT_NAME:STATIC=hello

// during RELEASE builds.
CMAKE_STATIC_LINKER_FLAGS_RELEASE:STRING=

//Flags used by the linker during the creation of static libraries
// during RELWITHDEBINFO builds.
CMAKE_STATIC_LINKER_FLAGS_RELWITHDEBINFO:STRING=

//Path to a program.
CMAKE_STRIP:FILEPATH=G:/app/mingw64/bin/strip.exe

//Path to a program.
CMAKE_TAPI:FILEPATH=CMAKE_TAPI-NOTFOUND

//If this value is on, makefiles will be generated without the
// .SILENT directive, and all commands will be echoed to the console
// during the make.  This is useful for debugging only. With Visual
// Studio IDE projects all commands are done without /nologo.
CMAKE_VERBOSE_MAKEFILE:BOOL=FALSE

//Value Computed by CMake
hello_BINARY_DIR:STATIC=D:/code/cmake/template/add_source/build

//Value Computed by CMake
hello_IS_TOP_LEVEL:STATIC=ON

//Value Computed by CMake
hello_SOURCE_DIR:STATIC=D:/code/cmake/template/add_source

```

### 3.环境变量
环境变量与常规变量差不多，但是有细微的区别。
* 环境变量在 CMake 执行过程中具有全局范围，并且它们永远不会被缓存。
* 更改环境变量的值作用于当前运行的 CMake 进程，而不影响整个系统环境

```cmake
# 设置环境变量
set(ENV{<variable>} [<value>] ...)

# 取消环境变量
unset(ENV{<variable>})

# 获取环境变量
$ENV{<variable>}

```

使用案例

```cmake
cmake_minimum_required(VERSION 3.0.0)

set(ENV{PATH} "/tmp;$ENV{PATH}")
message("PATH: $ENV{PATH}")

```

## 内置变量

cmake内置了很多变量
### 1. **项目相关变量**

- **CMAKE_PROJECT_NAME** ：当前顶层项目的名称（由 `project()` 命令指定）。
- **PROJECT_NAME** ： 当前处理的项目名称（支持多层 `project()` 嵌套）。
- **CMAKE_SOURCE_DIR** ： 顶层 CMakeLists.txt 所在目录的完整路径。
- **PROJECT_SOURCE_DIR** ： 当前 `project()` 命令对应的源目录。
- **CMAKE_BINARY_DIR** ： 顶层构建目录的完整路径（`cmake` 命令的执行目录）。
- **PROJECT_BINARY_DIR** ： 当前 `project()` 命令对应的构建目录。
- **CMAKE_CURRENT_SOURCE_DIR** ： 当前处理的 CMakeLists.txt 所在的源目录。
- **CMAKE_CURRENT_BINARY_DIR** ： 当前处理的 CMakeLists.txt 的构建目录。
- **EXECUTABLE_OUTPUT_PATH**: 可执行文件输出的存放路径
- **LIBRARY_OUTPUT_PATH**:：库文件输出的存放路径
### 2. **编译相关变量**

- **CMAKE_C_COMPILER**  、**`CMAKE_CXX_COMPILER`** C 编译器的路径、C++ 编译器的路径。编译器，绝对路径或者在环境变量**PATH**路径中能找
- **CMAKE_LINKER**  链接器工具路径。
- CMAKE_SYSTEM_NAME：程序运行的目标操作系统，如果 `CMAKE_SYSTEM_NAME` 未指定，CMake 将假定目标系统与构建系统相同（即非交叉编译），交叉编译必须定义，且编译器也必须指定
   以下是一些常见的 `CMAKE_SYSTEM_NAME` 值及其对应的系统：
   - **Windows**：目标是 Windows 系统。
   - **Linux**：目标是 Linux 系统。
   - **Darwin**：目标是 macOS。
   - **FreeBSD**：目标是 FreeBSD。
   - **iOS**：目标是 iOS 系统。
   - **Android**：目标是 Android 系统。
   - **Generic**：目标是一个无操作系统的嵌入式(裸机)或定制操作系统(RTOS)
* **CMAKE_EXPORT_COMPILE_COMMANDS**：bool类型，是否导出**compile_commands.json**文件，vscode使用此文件可以实现代码补全和跳转
* **CMAKE_BUILD_TYPE** ： 指定单配置生成器的构建类型（如 `Debug`、`Release`、`RelWithDebInfo`、`MinSizeRel`），会影响内置默认的编译参数(优化参数)
* **CMAKE_C_FLAGS**、**CMAKE_CXX_FLAGS**：  C 编译器、C++ 编译器的全局编译标志，类似环境变量，所有编译命令都会使用
- **CMAKE_SHARED_LINKER_FLAGS**  链接共享库时的标志，类似环境变量，所有链接命令都会使用
- **CMAKE_EXE_LINKER_FLAGS** 链接可执行文件时的标志，类似环境变量，所有链接命令都会使用

###  3. **路径相关变量**

- **CMAKE_INSTALL_PREFIX**  安装路径前缀（默认Linux系统 `/usr/local` ，windos系统`C:/Program Files`）。
- **CMAKE_MODULE_PATH**  搜索自定义模块文件的路径列表，自己写的`Find<libname>.cmake`文件的默认查找目录
- **CMAKE_PREFIX_PATH**  搜索库、程序和头文件的前缀路径列表，例如：qt 库路径
- **CMAKE_INCLUDE_PATH**: 设置后find_path()命令默认会去这里找，当然加在PATH更好
- **CMAKE_LIBRARY_PATH**：设置后find_library()默认会去这里找，当然加在PATH后更好
