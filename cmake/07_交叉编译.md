## 前言
交叉编译稍微麻烦一点，因为常规情况下cmake认为构建和运行是同平台的，但是cmake也支持交叉编译，需要设置合适的变量。
支持多数交叉编译器，在cmake的内置模块Modules/Compiler文件夹下有所有支持的编译器脚本，到cmake 3.30版本为止支持以下常见交叉编译器：
+ ARMCC
+ ARMClang
+ IAR
+ ARM GCC
+ TIClang
+ TI DSP

## 添加交叉编译器

以添加ARMClang为例
```cmake

set(CMAKE_SYSTEM_NAME Generic)
set(CMAKE_SYSTEM_PROCESSOR cortex-m7)

set(CMAKE_C_COMPILER armclang.exe)  
set(CMAKE_CXX_COMPILER armclang.exe)  
set(CMAKE_ASM_COMPILER armclang.exe)  
set(CMAKE_AR armar.exe)  
set(CMAKE_LINKER armlink.exe)  
set(CMAKE_RROMELF fromelf.exe)

```

## 编译命令执行原理
在非交叉编译中这部分无需过问。在交叉编译时需要添加特殊的编译参数，而cmake又是根据CMakeLists.txt脚本自动生成的，不同编译器cmake生成的规则不同，由于使用特定编译器的人太少cmake无法考虑全面或者不是想要的编译器命令行参数顺序，所以需要知道cmake是如何组织编译和链接命令。

```cmake

#cmake内置模块打印内部一些变量信息
include(CMakePrintSystemInformation)

```

输出以下信息
```shell
[cmake] CMAKE_SYSTEM is Generic Generic  cortex-m7
[cmake] CMAKE_SYSTEM file is Platform/Generic
[cmake] CMAKE_C_COMPILER is C:/Programs/keil5/ARM/ARMCLANG/bin/armclang.exe
[cmake] CMAKE_CXX_COMPILER is C:/Programs/keil5/ARM/ARMCLANG/bin/armclang.exe
[cmake] CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS is -shared
[cmake] CMAKE_SHARED_LIBRARY_CREATE_CXX_FLAGS is -shared
[cmake] CMAKE_DL_LIBS is dl
[cmake] CMAKE_SHARED_LIBRARY_PREFIX is lib
[cmake] CMAKE_SHARED_LIBRARY_SUFFIX is .so
[cmake] CMAKE_COMPILER_IS_GNUCC = 
[cmake] CMAKE_COMPILER_IS_GNUCXX = 
[cmake] CMAKE_CXX_CREATE_SHARED_LIBRARY is <CMAKE_CXX_COMPILER> <CMAKE_SHARED_LIBRARY_CXX_FLAGS> <LANGUAGE_COMPILE_FLAGS> <LINK_FLAGS> <CMAKE_SHARED_LIBRARY_CREATE_CXX_FLAGS> <SONAME_FLAG><TARGET_SONAME> -o <TARGET> <OBJECTS> <LINK_LIBRARIES>
[cmake] CMAKE_CXX_CREATE_SHARED_MODULE is <CMAKE_CXX_COMPILER> <CMAKE_SHARED_LIBRARY_CXX_FLAGS> <LANGUAGE_COMPILE_FLAGS> <LINK_FLAGS> <CMAKE_SHARED_LIBRARY_CREATE_CXX_FLAGS> <SONAME_FLAG><TARGET_SONAME> -o <TARGET> <OBJECTS> <LINK_LIBRARIES>
[cmake] CMAKE_CXX_CREATE_STATIC_LIBRARY is <CMAKE_AR> --create -cr <TARGET> <LINK_FLAGS> <OBJECTS>
[cmake] CMAKE_CXX_COMPILE_OBJECT is <CMAKE_CXX_COMPILER> <DEFINES> <INCLUDES> <FLAGS> -o <OBJECT> -c <SOURCE>
[cmake] CMAKE_CXX_LINK_EXECUTABLE <CMAKE_LINKER> <CMAKE_CXX_LINK_FLAGS> <LINK_FLAGS> <LINK_LIBRARIES> <OBJECTS> -o <TARGET>  --list=<TARGET_BASE>.map
[cmake] CMAKE_C_CREATE_SHARED_LIBRARY is <CMAKE_C_COMPILER> <CMAKE_SHARED_LIBRARY_C_FLAGS> <LANGUAGE_COMPILE_FLAGS> <LINK_FLAGS> <CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS> <SONAME_FLAG><TARGET_SONAME> -o <TARGET> <OBJECTS> <LINK_LIBRARIES>
[cmake] CMAKE_C_CREATE_SHARED_MODULE is <CMAKE_C_COMPILER> <CMAKE_SHARED_LIBRARY_C_FLAGS> <LANGUAGE_COMPILE_FLAGS> <LINK_FLAGS> <CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS> <SONAME_FLAG><TARGET_SONAME> -o <TARGET> <OBJECTS> <LINK_LIBRARIES>
[cmake] CMAKE_C_CREATE_STATIC_LIBRARY is <CMAKE_AR> --create -cr <TARGET> <LINK_FLAGS> <OBJECTS>
[cmake] CMAKE_C_COMPILE_OBJECT is <CMAKE_C_COMPILER> <DEFINES> <INCLUDES> <FLAGS> -o <OBJECT> -c <SOURCE>
[cmake] CMAKE_C_LINK_EXECUTABLE <CMAKE_LINKER> <CMAKE_C_LINK_FLAGS> <LINK_FLAGS> <LINK_LIBRARIES> <OBJECTS> -o <TARGET>  --list=<TARGET_BASE>.map
[cmake] CMAKE_SYSTEM_AND_CXX_COMPILER_INFO_FILE 
[cmake] CMAKE_SYSTEM_AND_C_COMPILER_INFO_FILE 
```

重要变量：
+ CMAKE_C_CREATE_STATIC_LIBRARY
+ CMAKE_C_COMPILE_OBJECT
+ CMAKE_C_LINK_EXECUTABLE
+ 